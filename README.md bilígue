

# ðŸ“˜ TP4 Projeto de Bloco (2025)

## ðŸ‡§ðŸ‡· PortuguÃªs

### ðŸ“Œ DescriÃ§Ã£o
Este projeto foi desenvolvido como parte do **TP4 â€“ Projeto de Bloco (2025)**.  
O objetivo Ã© manipular dados em um banco de dados **PostgreSQL** utilizando **Python** e **SQLAlchemy**, realizando operaÃ§Ãµes de **UPSERT** (inserÃ§Ã£o/atualizaÃ§Ã£o) e **deleÃ§Ã£o massiva** a partir de arquivos JSON.

---

### ðŸŽ¯ OrientaÃ§Ãµes do TP4
1. Criar um arquivo JSON com orientaÃ§Ã£o a registros para carga massiva (inserÃ§Ã£o ou atualizaÃ§Ã£o) de uma tabela no PostgreSQL.  
2. Criar um arquivo JSON com orientaÃ§Ã£o a registros para deleÃ§Ã£o massiva.  
3. Implementar cÃ³digo em Python usando SQLAlchemy para realizar UPSERT (INSERT + UPDATE).  
4. Validar o sucesso da inserÃ§Ã£o/atualizaÃ§Ã£o.  
5. Repetir o processo para deleÃ§Ã£o massiva.  
6. Validar o sucesso da deleÃ§Ã£o.  

---

### âš™ï¸ Estrutura do Projeto
- **`alunos.json`** â†’ arquivo com registros para inserÃ§Ã£o/atualizaÃ§Ã£o.  
- **`alunos_deletar.json`** â†’ arquivo com registros para deleÃ§Ã£o.  
- **`db_conect.py`** â†’ mÃ³dulo de conexÃ£o ao banco e funÃ§Ãµes (`upsert_aluno`, `delete_alunos`).  
- **`main.py`** â†’ script principal que chama as funÃ§Ãµes e executa as operaÃ§Ãµes.  

---

### ðŸš€ Como Executar
1. Configure o banco PostgreSQL e crie a tabela `academic.aluno`.  
2. Ajuste as credenciais no dicionÃ¡rio `DB` em `db_conect.py`.  
3. Crie os arquivos `alunos.json` e `alunos_deletar.json`.  
4. Execute o script principal:
   ```bash
   python3 main.py
   ```
5. Verifique no banco se os registros foram inseridos/atualizados ou deletados.  

---

### ðŸ“‚ Exemplo de JSON
**InserÃ§Ã£o/AtualizaÃ§Ã£o (`alunos.json`):**
```json
[
  { "cpf": "11111111111", "nome": "Ana Silva", "datanascimento": "2001-05-10" },
  { "cpf": "22222222222", "nome": "Carlos Souza", "datanascimento": "1999-12-01" }
]
```

**DeleÃ§Ã£o (`alunos_deletar.json`):**
```json
[
  { "cpf": "11111111111" },
  { "cpf": "22222222222" }
]
```

---

### ðŸ”„ Fluxo do Projeto
```
+-------------------+        +------------------+        +-------------------+        +------------------+
|   alunos.json     | -----> |   Pandas DataFrame | -----> |  upsert_aluno()   | -----> |  PostgreSQL DB   |
| (inserÃ§Ã£o/atual.) |        |   (df)            |        |  (SQLAlchemy UPSERT)|        | academic.aluno   |
+-------------------+        +------------------+        +-------------------+        +------------------+

+-------------------+        +------------------+        +-------------------+        +------------------+
| alunos_deletar.json| -----> | Pandas DataFrame | -----> | delete_alunos()   | -----> |  PostgreSQL DB   |
| (deleÃ§Ã£o massiva) |        |   (df_delete)    |        |  (SQLAlchemy DELETE)|       | academic.aluno   |
+-------------------+        +------------------+        +-------------------+        +------------------+
```

---

## ðŸ‡ºðŸ‡¸ English

### ðŸ“Œ Description
This project was developed as part of **TP4 â€“ Block Project (2025)**.  
The goal is to manipulate data in a **PostgreSQL** database using **Python** and **SQLAlchemy**, performing **UPSERT** (insert/update) and **mass deletion** operations from JSON files.

---

### ðŸŽ¯ TP4 Guidelines
1. Create a JSON file with record-oriented structure for bulk insert/update.  
2. Create a JSON file with record-oriented structure for bulk deletion.  
3. Implement Python code using SQLAlchemy to perform UPSERT (INSERT + UPDATE).  
4. Validate the success of insert/update operations.  
5. Repeat the process for mass deletion.  
6. Validate the success of deletion.  

---

### âš™ï¸ Project Structure
- **`alunos.json`** â†’ file with records for insert/update.  
- **`alunos_deletar.json`** â†’ file with records for deletion.  
- **`db_conect.py`** â†’ database connection and functions (`upsert_aluno`, `delete_alunos`).  
- **`main.py`** â†’ main script that calls the functions and executes operations.  

---

### ðŸš€ How to Run
1. Set up PostgreSQL and create the `academic.aluno` table.  
2. Adjust credentials in the `DB` dictionary inside `db_conect.py`.  
3. Create the files `alunos.json` and `alunos_deletar.json`.  
4. Run the main script:
   ```bash
   python3 main.py
   ```
5. Check the database to confirm records were inserted/updated or deleted.  

---

### ðŸ“‚ JSON Example
**Insert/Update (`alunos.json`):**
```json
[
  { "cpf": "11111111111", "nome": "Ana Silva", "datanascimento": "2001-05-10" },
  { "cpf": "22222222222", "nome": "Carlos Souza", "datanascimento": "1999-12-01" }
]
```

**Deletion (`alunos_deletar.json`):**
```json
[
  { "cpf": "11111111111" },
  { "cpf": "22222222222" }
]
```

---

### ðŸ”„ Project Flow
```
+-------------------+        +------------------+        +-------------------+        +------------------+
|   alunos.json     | -----> |   Pandas DataFrame | -----> |  upsert_aluno()   | -----> |  PostgreSQL DB   |
| (insert/update)   |        |   (df)            |        |  (SQLAlchemy UPSERT)|        | academic.aluno   |
+-------------------+        +------------------+        +-------------------+        +------------------+

+-------------------+        +------------------+        +-------------------+        +------------------+
| alunos_deletar.json| -----> | Pandas DataFrame | -----> | delete_alunos()   | -----> |  PostgreSQL DB   |
| (mass deletion)   |        |   (df_delete)    |        |  (SQLAlchemy DELETE)|       | academic.aluno   |
+-------------------+        +------------------+        +-------------------+        +------------------+
```
```

---
